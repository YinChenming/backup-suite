**软件测试报告（BackupSuite）**

**1. 引言**

为提升 BackupSuite 质量并支撑验收，制定本测试报告，明确测试范围、方法与结果。覆盖核心库、CLI、GUI（Qt）、备份格式支持（tar/zip/7z）以及健壮性与性能验证。

**2. 功能测试**

目标：验证需求用例（备份/恢复 tar、zip、7z；CLI/GUI 交互；过滤/加密选项；错误处理）。采用黑盒+组合路径测试，实测数据与期望结果对比。

**2.1 CLI 模块** 测试用例示例：

| 程序版本号 | 模块名         | 用例编号            | 用例级别 | 用例名称                     | 测试时间    | 预置条件                                   | 测试输入                                | 操作步骤                                                                                  | 预期结果                                     | 实际输出 | 测试人员 |
| ---------- | -------------- | ------------------- | -------- | ---------------------------- | ----------- | ------------------------------------------ | --------------------------------------- | ----------------------------------------------------------------------------------------- | -------------------------------------------- | -------- | -------- |
| 1.0.0      | CLI 备份/恢复  | TC-CLI-7Z-01        | 重要     | 7z 备份（含子目录与小文件）  | 2025-12-31  | third_party/7-Zip 已放置 7z.dll/7-zip.dll | `-7z test_data/source backup.7z`        | 1) 运行 CLI；2) 观察返回码；3) 校验生成的备份存在；4) 解压检查文件完整性                  | 退出码 0，生成 backup.7z，内容与源一致       | 通过     | YCM      |
| 1.0.0      | CLI 备份/恢复  | TC-CLI-TAR-02       | 重要     | tar 备份并读取校验           | 2025-12-31  | libarchive/SQLite 依赖已就绪              | `-t test_data/source backup.tar`        | 同上                                                                               | 退出码 0，生成 tar，TarDevice 可读取全部文件 | 通过     | YCM      |
| 1.0.0      | CLI 过滤       | TC-CLI-FILTER-03    | 次要     | 按扩展名过滤                 | 2025-12-31  | test_data 含混合扩展名                     | `-7z --include "*.txt" src dst.7z`     | 1) 运行；2) 解包检查仅包含 .txt 文件                                                  | 仅包含 .txt 条目                            | 通过     | YCM      |

**2.2 GUI 模块（Qt）** 测试要点：
- 主窗口加载与路径选择；格式选项（zip/tar/7z）切换；开始/取消按钮。
- 进度/日志更新；完成与错误提示。
- 依赖检查：Qt 平台插件、7z DLL 存在。

用例示例：
- TC-GUI-START-01：选择源/目标（7z），点击开始，进度正常推进，生成备份文件，完成提示。
- TC-GUI-ERROR-02：缺少 7z.dll 时启动备份，弹出错误提示，不生成文件。

**2.3 核心库模块（Device/Controller）**
- TarDevice/ZipDevice/SevenZipDevice：写入后再读取校验 `exists/get_file`，比对内容。
- BackupController：物理->tar/zip/7z，tar/zip/7z->物理的往返一致性。
- SystemDevice：符号链接/隐藏/只读文件的存在性与内容读取。

**3. 代码测试（可选）**
- 静态分析：建议使用 MSVC /analyze 或 clang-tidy；关注 DLL 导出警告（C4251）、类型转换告警（C4244/C4267），对无法消除的告警记录理由。
- 代码规范：命名/注释/接口一致性抽查核心模块（backup_controller.cpp、compresses_device.cpp、tar.cpp）。

**4. 性能测试（可选）**
- 小文件多数量场景：1 万小文件目录打包 7z，记录总耗时与平均吞吐；预期在可接受时间内（手工基线）。
- 单大文件场景：>1GB 文件 tar/zip 备份，关注内存占用与写入速率。
- 资源占用：任务期间监控峰值内存与 CPU 占用（任务管理器/Performance Monitor）。

**5. 健壮性测试（可选）**
- 依赖缺失：移除 7z.dll 后运行 `-7z`，期望友好报错且不生成残留文件。
- 路径异常：不可写目标目录、长路径、非法字符，期望报错并退出码非零。
- 中断场景：备份过程中手动终止进程，确认下次运行不会因残留临时文件导致崩溃。

**6. 测试结果分析**

| 测试模块        | 测试项目/场景                    | 测试结果 |
| ---------------- | -------------------------------- | -------- |
| CLI              | 7z/tar/zip 备份与过滤            | 通过     |
| Core Device      | Tar/Zip/7z 读写一致性            | 通过     |
| BackupController | 物理<->归档 往返一致性           | 通过     |
| GUI              | 启动/路径选择/进度与错误提示     | 通过     |
| 健壮性           | 缺依赖、不可写路径、长路径       | 通过     |
| 性能（抽样）     | 小文件批量 / 大文件单体          | 通过     |

结论：当前版本主要功能满足需求，用例全部通过；存在的编译告警已记录，运行期需确保 7z/Qt 依赖放置正确。后续可增加自动化性能基线与更多异常场景覆盖。
